<%= form_with model: [:admin, @commission], class: "admin-form" do |f| %>
  <% if @commission.errors.any? %>
    <div class="form-errors">
      <h4><%= pluralize(@commission.errors.count, "error") %> prevented saving:</h4>
      <ul>
        <% @commission.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="form-grid">
    <div class="form-main">
      <div class="form-card">
        <h3>Basic Information</h3>

        <div class="form-group">
          <%= f.label :user_id, "Customer", class: "form-label" %>
          <%= f.collection_select :user_id, @users, :id, :display_name, 
              { prompt: "Select a customer..." }, 
              { class: "form-select", required: true } %>
        </div>

        <div class="form-group">
          <%= f.label :title, class: "form-label" %>
          <%= f.text_field :title, class: "form-input", required: true %>
        </div>

        <div class="form-group">
          <%= f.label :description, class: "form-label" %>
          <%= f.text_area :description, class: "form-textarea", rows: 4 %>
        </div>

        <div class="form-row">
          <div class="form-group">
            <%= f.label :dimensions, class: "form-label" %>
            <%= f.text_field :dimensions, class: "form-input", placeholder: "e.g., 24\" x 36\"" %>
          </div>
          <div class="form-group">
            <%= f.label :location, "Installation Location", class: "form-label" %>
            <%= f.text_field :location, class: "form-input" %>
          </div>
        </div>
      </div>

      <div class="form-card">
        <h3>Notes</h3>

        <div class="form-group">
          <%= f.label :customer_notes, class: "form-label" %>
          <%= f.text_area :customer_notes, class: "form-textarea", rows: 3, placeholder: "Notes from the customer about their vision..." %>
        </div>

        <div class="form-group">
          <%= f.label :internal_notes, "Internal Notes (not visible to customer)", class: "form-label" %>
          <%= f.text_area :internal_notes, class: "form-textarea", rows: 3 %>
        </div>
      </div>
    </div>

    <div class="form-sidebar">
      <div class="form-card">
        <h3>Timeline</h3>

        <div class="form-group">
          <%= f.label :estimated_start_date, class: "form-label" %>
          <%= f.date_field :estimated_start_date, class: "form-input" %>
        </div>

        <div class="form-group">
          <%= f.label :estimated_completion_date, class: "form-label" %>
          <%= f.date_field :estimated_completion_date, class: "form-input" %>
        </div>
      </div>

      <div class="form-card">
        <h3>Pricing</h3>

        <div class="form-group">
          <%= f.label :estimated_price, class: "form-label" %>
          <%= f.number_field :estimated_price, class: "form-input", step: 0.01, min: 0 %>
        </div>

        <div class="form-group">
          <%= f.label :final_price, class: "form-label" %>
          <%= f.number_field :final_price, class: "form-input", step: 0.01, min: 0 %>
        </div>

        <div class="form-group">
          <%= f.label :deposit_amount, class: "form-label" %>
          <%= f.number_field :deposit_amount, class: "form-input", step: 0.01, min: 0 %>
        </div>

        <div class="form-group">
          <label class="form-checkbox">
            <%= f.check_box :deposit_paid %>
            <span>Deposit Paid</span>
          </label>
        </div>
      </div>
    </div>
  </div>

  <div class="form-actions">
    <%= f.submit @commission.persisted? ? "Update Commission" : "Create Commission", class: "btn btn--primary btn--lg" %>
    <%= link_to "Cancel", admin_commissions_path, class: "btn btn--ghost btn--lg" %>
  </div>
<% end %>
